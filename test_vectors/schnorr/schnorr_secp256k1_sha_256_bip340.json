{
  "testType": "SchnorrVerify",
  "algorithm": {
    "algorithmType": "Schnorr",
    "curve": "secp256k1",
    "sha": "SHA-256",
    "encoding": "BIP340",
    "normalize": true,
    "signature_generation": "Generic"
  },
  "version": "0.62",
  "description": [
    "The underlying elliptic curve is secp256k1.",
    "The message digest for hashing the input is SHA-256.",
    "Signatures consists of two parts R,s where R,s are encoded as unsigned, bigendian, fixed-length byte arrays."
  ],
  "numTests": 40,
  "references": [{
      "docId": "BIP-340"
    }],
  "notes": {
    "Basic": {
      "type": "GENERATION",
      "desc": "Basic test vectors use the simplest possible inputs. These inputs often overlap with inputs from standards and RFCs. One goal of such test vectors is to simply detect distinct algorithms."
    },
    "InvalidSignature": {
      "type": "CONSTRUCTED",
      "desc": "The test contains invalid signatures with edge case values. The main purpose of these signatures is to check for incorrect handling of such edge cases."
    },
    "ModifiedSignature": {
      "type": "CONSTRUCTED",
      "desc": "The test vector was generated by a faulty signer. "
    }
  },
  "tests": [
    {
      "tcId": 1,
      "publicKeyBip340": "1be8a2d1099d238bab27295703f53b81d46618ea796005719b0331918ba34d32",
      "msg": "",
      "sig": "5d92a332b29c982f83a7890dc0074c3dfe0885fc2c769266375b0cda11ade39f30aa72f23553abf4a1366be4425239e387a8fbc463da2d6a3d2b5fe4de0aa3a7",
      "comment": "normal",
      "valid": true,
      "flags": ["Basic"]
    },
    {
      "tcId": 2,
      "publicKeyBip340": "1be8a2d1099d238bab27295703f53b81d46618ea796005719b0331918ba34d32",
      "msg": "61",
      "sig": "91e7d2420e421cacc2d24d1aeece094e627f747f342d4c208e22a92aeb9323ca41aec7bd897fe8f1cb70bf5bdc6656cc05a8d45ee9a2f963e1be678f2fdda8e5",
      "comment": "normal",
      "valid": true,
      "flags": ["Basic"]
    },
    {
      "tcId": 3,
      "publicKeyBip340": "1be8a2d1099d238bab27295703f53b81d46618ea796005719b0331918ba34d32",
      "msg": "616263",
      "sig": "67af7baad4620948929c144214e5a0d5cc8acbffd0e9c632207663b16a533c516134d1966e627193185685a97612fadc9103c4dcd2cc7206b19aa4b8c01b2bb5",
      "comment": "normal",
      "valid": true,
      "flags": ["Basic"]
    },
    {
      "tcId": 4,
      "publicKeyBip340": "1be8a2d1099d238bab27295703f53b81d46618ea796005719b0331918ba34d32",
      "msg": "00000000000000000000000000000000",
      "sig": "d240f585063678533435b024a8d0dd1838f358fb1d2fb73a38d5a81ddef0b3654ce5bdad3ecbb8ff20f0f8305c55b41ba584f26540a956dcd12d0761e1e28f69",
      "comment": "normal",
      "valid": true,
      "flags": ["Basic"]
    },
    {
      "tcId": 5,
      "publicKeyBip340": "1be8a2d1099d238bab27295703f53b81d46618ea796005719b0331918ba34d32",
      "msg": "616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161",
      "sig": "0ee559fd954c2e2a43dd28edee3d8bea038b9f68dfd294ae264cb10bcf363c7e180a60e33a1440ff94551a2bd7fe515f6cb71a80b14e19d908fd0ebb96d0f163",
      "comment": "normal",
      "valid": true,
      "flags": ["Basic"]
    },
    {
      "tcId": 6,
      "publicKeyBip340": "1be8a2d1099d238bab27295703f53b81d46618ea796005719b0331918ba34d32",
      "msg": "ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",
      "sig": "d4c45e552fa9b943ca5ba311b1ddfc213db2ff6534c09192cffa59df8b3ffdcd78256981e207064209aefae6c19dd1c19c9ed45baa3f57c043a4df1d631e4561",
      "comment": "normal",
      "valid": true,
      "flags": ["Basic"]
    },
    {
      "tcId": 7,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "7bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca342b086a6aec54b2a6d5f7d0d27b6fa8275f59c2d237c9aa26791a96731f1b86cd9",
      "comment": "last bit of R changed",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 8,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "3bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca3438107c35aecf32984b750484021b9c51c44ee1b458297dc7f64c74d70eb4be2b7",
      "comment": "first bit of R changed",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 9,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "84374f651f38ca8a4a967f610c9130cec3487a6c314208e7333bbd64941358ec509cb87a0d6f5455b69ea19cea5ca3d4743e523a9014b6a91506565e1069fcea",
      "comment": "Negative x-coordinate of R",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 10,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "7bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca349ae9fbdd72b3c626f694d1edd876b7edf1ed8dd119d5eaa499de7d7c06df7bf42",
      "comment": "incorrect R",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 11,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "7bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca341e33f46e8de1680939b60b91b0f73ae01b67fdc0d8932f8a5f663e4f549b61528",
      "comment": "R is not a point",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 12,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2facf8d9f214388cdd4795a6c1cb882d4485fb425536615b761a4950f5e6e8da7d",
      "comment": "R with coordinate p",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 13,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffb279cdacb2646000f6ffb4544caa3156cf98bdf7985381e4a514c43572bb1a01",
      "comment": "R too large",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 14,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2facf8d9f214388cdd4795a6c1cb882d4485fb425536615b761a4950f5e6e8da7d",
      "comment": "R = p",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 15,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd03641413c027a0d5914a07cfe01908313d94e892a179e279af64fe728662e4a7ea1cedb",
      "comment": "R = n",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 16,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "0000000000000000000000000000000000000000000000000000000000000000c8cbf058979de2bc192271451cf2a640d4391c253c20144a8455b8b67873fcb4",
      "comment": "R = 0",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 17,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "7bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca3431736a4c13634854145ff92a1e836d55b2144aa18a64d64ec734b85bf695c2e9a",
      "comment": "parity of R is incorrect",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 18,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "7bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca3430000000000000000000000000000000000000000000000000000000000000000",
      "comment": "s = 0",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 19,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "7bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca343fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",
      "comment": "s = n",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 20,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "7bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca343b07663dd7737ff79766b99d0f9e408f9ea465f65d190bd37dcd91cd2c5595049",
      "comment": "s = n-s",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 21,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "7bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca343ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",
      "comment": "s = 2**256-1",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 22,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "7bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca34333602071df7e42e3e7c9fc687729662ff8d693ccc202a3f82b2263bcba1c8fc9",
      "comment": "Point at infinity during verification",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 23,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "7bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca343cc9fdf8e2081bd1c1836039788d699cec1d84919ed45fc4394affad01619b178",
      "comment": "Point doubling during verification",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 24,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "7bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca343",
      "comment": "missing s in signature",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 25,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "7bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca343014f899c2288c800868994662f061bf7038b175a678d00833fa2cba046db133239",
      "comment": "s not reduced",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 26,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "7bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca343004f899c2288c800868994662f061bf704d0687d80ddb7e303e2f941ba0adcf0f8",
      "comment": "extra leading zero in s",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 27,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
      "comment": "signature is all zero",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 28,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "",
      "comment": "empty signature",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 29,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "7bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca3434f899c2288c800868994662f061bf704d0687d80ddb7e303e2f941ba0adcf0",
      "comment": "truncated signature",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 30,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "007bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca343004f899c2288c800868994662f061bf704d0687d80ddb7e303e2f941ba0adcf0f8",
      "comment": "additional zeros in signatures",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 31,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "7bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca3434f899c2288c800868994662f061bf704d0687d80ddb7e303e2f941ba0adcf0f80000",
      "comment": "garbage appended to signature",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 32,
      "publicKeyBip340": "d0d9e3bfe10d45556e036b101879a98adb1cc91e1e1775967d3235aa5c5458ac",
      "msg": "54657374",
      "sig": "7bc8b09ae0c73575b569809ef36ecf313cb78593cebdf718ccc4429a6beca3434f899c2288c800868994662f061bf704d0687d80ddb7e303e2f941ba0adcf0f800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
      "comment": "checking for overflows",
      "valid": false,
      "flags": ["ModifiedSignature"]
    },
    {
      "tcId": 33,
      "publicKeyBip340": "ba0d7b6d552f4c67959310f617f1423ae85ea48a657f56482e36b4ab46e0a35a",
      "msg": "54657374",
      "sig": "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
      "comment": "R=0, s=0",
      "valid": false,
      "flags": ["InvalidSignature"]
    },
    {
      "tcId": 34,
      "publicKeyBip340": "ba0d7b6d552f4c67959310f617f1423ae85ea48a657f56482e36b4ab46e0a35a",
      "msg": "54657374",
      "sig": "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001",
      "comment": "R=0, s=1",
      "valid": false,
      "flags": ["InvalidSignature"]
    },
    {
      "tcId": 35,
      "publicKeyBip340": "ba0d7b6d552f4c67959310f617f1423ae85ea48a657f56482e36b4ab46e0a35a",
      "msg": "54657374",
      "sig": "00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000",
      "comment": "R=1, s=0",
      "valid": false,
      "flags": ["InvalidSignature"]
    },
    {
      "tcId": 36,
      "publicKeyBip340": "ba0d7b6d552f4c67959310f617f1423ae85ea48a657f56482e36b4ab46e0a35a",
      "msg": "54657374",
      "sig": "00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001",
      "comment": "R=1, s=1",
      "valid": false,
      "flags": ["InvalidSignature"]
    },
    {
      "tcId": 37,
      "publicKeyBip340": "ba0d7b6d552f4c67959310f617f1423ae85ea48a657f56482e36b4ab46e0a35a",
      "msg": "54657374",
      "sig": "fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2ffffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",
      "comment": "R=p, s=n",
      "valid": false,
      "flags": ["InvalidSignature"]
    },
    {
      "tcId": 38,
      "publicKeyBip340": "ba0d7b6d552f4c67959310f617f1423ae85ea48a657f56482e36b4ab46e0a35a",
      "msg": "54657374",
      "sig": "fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",
      "comment": "R=n, s=n",
      "valid": false,
      "flags": ["InvalidSignature"]
    },
    {
      "tcId": 39,
      "publicKeyBip340": "ba0d7b6d552f4c67959310f617f1423ae85ea48a657f56482e36b4ab46e0a35a",
      "msg": "54657374",
      "sig": "fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f0000000000000000000000000000000000000000000000000000000000000001",
      "comment": "R=p",
      "valid": false,
      "flags": ["InvalidSignature"]
    },
    {
      "tcId": 40,
      "publicKeyBip340": "ba0d7b6d552f4c67959310f617f1423ae85ea48a657f56482e36b4ab46e0a35a",
      "msg": "54657374",
      "sig": "0000000000000000000000000000000000000000000000000000000000000001fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",
      "comment": "s=n",
      "valid": false,
      "flags": ["InvalidSignature"]
    }
  ]
}